<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Random Dark Meme</title>
  <style>
    body { font-family: Arial; background:#111; color:#fff; text-align:center; }
    img { max-width:90vw; max-height:80vh; border-radius:10px; margin-top:15px; }
    button {
      background:#fff; color:#000; padding:10px 20px; border:0;
      border-radius:8px; cursor:pointer; font-size:18px; margin-top:20px;
    }
  </style>
</head>
<body>

  <h1>Random Dark Meme</h1>
  <button onclick="loadMeme()">Get Another</button>

  <h2 id="title"></h2>
  <img id="image" />
  <p id="sub"></p>

<script>
const subreddits = [
  "Jokesuncensored",
  "cursedmemes",
  "darkmemes",
  "OffensiveMemes",
  "imgoingtohellforthis",
  "dankmemes"
];

// FREE CORS-friendly Reddit API mirror
// (works in static browser apps)
const API = "https://api.redditjs.com/r/";

async function loadMeme() {
  const sr = subreddits[Math.floor(Math.random() * subreddits.length)];

  try {
    const res = await fetch(`${API}${sr}/hot?limit=50`);
    const json = await res.json();

    // Redditjs.com mirrors Redditâ€™s structure
    const posts = json.data.children;

    // FILTER IMAGE POSTS ONLY
    const imgs = posts.filter(p => {
      const d = p.data;
      const isImg = d.post_hint === "image";
      const ext = d.url.match(/\.(jpg|jpeg|png|gif)$/i);
      return isImg || ext;
    });

    if (imgs.length === 0) {
      document.getElementById("title").innerText =
        "No images found. Try again.";
      return;
    }

    const meme = imgs[Math.floor(Math.random() * imgs.length)].data;

    document.getElementById("title").innerText = meme.title;
    document.getElementById("image").src = meme.url;
    document.getElementById("sub").innerText = `r/${sr}`;

  } catch (e) {
    console.error(e);
    alert("Failed to load meme. Try again.");
  }
}

// Load immediately on open
loadMeme();
</script>

</body>
</html>
